# Insecure Direct Object References (IDOR)
### 1. Identification & Reconnaissance
The first step is locating Direct Object References in the application.
- **URL Parameters:** Look for sequential IDs in `GET` requests (e.g., `?uid=1`, `?doc_id=505`).
- **API Endpoints:** Inspect REST calls for resource identifiers (e.g., `/api/users/1`).
- **HTTP Headers:** Check cookies or custom headers for user IDs.
- **AJAX Calls:** Review frontend JavaScript for unused API endpoints or parameters (e.g., disabled admin functions).
- **Encoded/Hashed IDs:** Detect and decode obscured references.
    - **Base64:** Identifiable character set (A-Z, a-z, 0-9, +, /). Decode, modify plaintext ID, re-encode.
    - **Hashing:** If IDs look hashed (e.g., MD5), check frontend JS for the hashing logic (e.g., `md5(uid)`).
### 2. Basic Exploitation (Manual Testing)
Attempt to access resources belonging to other users.
- **Parameter Manipulation:** Change `uid=1` to `uid=2` and observe the response.
    - _Check:_ Does the content change? Do file names or sizes differ?
- **Static File IDOR:** Predict file names based on patterns (e.g., `/documents/Invoice_1_09_2021.pdf`).
- **HTTP Verb Tampering:** If `GET` is blocked, try accessing the resource via `POST` or `PUT`.
### 3. Mass Enumeration (Automation)
Once a pattern is confirmed, automate the retrieval of all accessible data.
- **Bash Scripting:** Use `curl` and loops to iterate through IDs.
    - _Example:_ Loop through `uid` 1 to 1000, grep for file links, and download them.
- **Burp Intruder / ZAP Fuzzer:** Configure payloads to iterate sequentially (Numbers) or use a wordlist.
- **Regex Extraction:** Use tools like `grep` to extract specific data (e.g., document paths) from the responses.
### 4. Advanced Exploitation (API Abuse)
Modern apps often use JSON-based APIs. IDOR here can lead to full account takeovers.
- **Information Disclosure (GET):**
    - Request `/api/users/2` (another user).
    - _Goal:_ Leak sensitive fields like `uuid`, `email`, or `role`.
- **Insecure Function Calls (PUT/POST/DELETE):**
    - **Modify Details:** Use leaked IDs (`uuid`) to update another user's email (Account Takeover) or inject XSS payloads.
    - **Privilege Escalation:** Attempt to modify your own `role` parameter in the JSON body (e.g., `"role": "admin"`).
- **Parameter Pollution:** Add parameters that aren't usually sent (e.g., adding `"admin": true` to a profile update request).
### 5. Chaining Vulnerabilities
Combine IDOR findings to maximize impact.
- **IDOR + IDOR:** Leak a user's private `uuid` via a GET IDOR, then use that `uuid` to perform a PUT IDOR to change their password.
- **IDOR + XSS:** Use IDOR to modify another user's profile and insert a stored XSS payload that executes when they view it.
- **IDOR + Mass Assignment:** Use administrative API endpoints (discovered via IDOR) to bulk-modify user attributes.
### Key Remediation Concepts
- **Access Control:** Always enforce server-side checks verifying that the logged-in user is authorized to access the requested object. 
- **Indirect References:** Use random, non-sequential tokens (UUIDs) mapped to internal IDs on the backend (Reference Map), rather than exposing database keys directly.