# HTTP Verb Tampering
**Concept:** Web servers and applications often enforce security rules based on the HTTP verb. If the rule says "Block `POST` requests to `/admin`," sending a `HEAD` request might bypass the check while still triggering the backend function. 
**Impact:** Authentication Bypass, Security Filter/WAF Evasion.
## 1. Reconnaissance (Allowed Methods)
**Goal:** Determine which HTTP methods are supported by the server. 
**Tool:** `curl` or Burp Suite.
### Check Supported Verbs (`OPTIONS`)
Send an `OPTIONS` request to see the `Allow` header.
```shell
# Syntax: curl -i -X OPTIONS <Target_URL>
curl -i -X OPTIONS http://SERVER_IP:PORT/

# Output Example:
# HTTP/1.1 200 OK
# Allow: POST, OPTIONS, HEAD, GET  <-- Target Verbs
```
### Verb Dictionary
| **Verb** | **Usage in Attacks**                                                                  |
| -------- | ------------------------------------------------------------------------------------- |
| `HEAD`   | Identical to `GET` but returns no body. Often bypasses Auth checks that expect `GET`. |
| `PUT`    | Uploads/Writes data. Can bypass filters expecting `POST`.                             |
| `DELETE` | Deletes resources.                                                                    |
| `PATCH`  | Partial modifications. Often overlooked by WAFs.                                      |
## 2. Attack: Bypassing Basic Authentication
**Scenario:** An administrative function (e.g., `/reset.php`) requires Basic Auth when accessed via `GET` or `POST`. 
**Vulnerability:** The Access Control List (ACL) configuration might look like `<Limit GET POST> Require valid-user </Limit>`. This leaves `HEAD` unrestricted.
### Execution (Burp Suite)
1. **Intercept** the request to the protected resource.
2. **Right-Click** -> `Change Request Method`.
    - _Burp automatically toggles between GET and POST._
3. **Manual Edit:** If Burp doesn't offer the desired verb, send to **Repeater** (`Ctrl+R`) and manually type `HEAD` in the top line.
```http
HEAD /admin/reset.php HTTP/1.1
Host: target.com
```
4. **Forward:** If the server returns `200 OK` (instead of `401 Unauthorized`), the function likely executed.

**OPSEC Warning:** `HEAD` requests do not return a response body. You will not see a "Success" message on the screen, but the backend action (e.g., database reset) will still occur. Verify the effect via a secondary channel (e.g., checking if files were deleted).
## 3. Attack: Bypassing Security Filters (WAFs)
**Scenario:** A WAF or Input Validation filter blocks malicious characters (e.g., `;`, `|`, `'`) in `POST` requests to prevent Command Injection. 
**Vulnerability:** The filter logic checks `$_POST['param']` but the application logic processes `$_REQUEST['param']` (which includes both GET and POST).
### Execution Steps
1. **Identify the Block:** Send a malicious payload via `POST`.
    - _Payload:_ `file1; touch file2;`
    - _Result:_ `403 Forbidden` or `Malicious Request Denied!`
2. **Tamper the Verb:** Change the method to `GET` (or `PUT`/`PATCH` if allowed).
    - _Action:_ Move parameters from the Body to the URL (if switching POST -> GET).
3. **Re-Send:**
```http
GET /file_manager.php?filename=file1;%20touch%20file2; HTTP/1.1
Host: target.com
```
4. **Verification:** If the WAF was only configured to inspect `POST` bodies, the `GET` request will pass through, and the backend will execute the injected command.