# Attacking Web Applications with Ffuf
## 1. Basic Directory Fuzzing
The goal of directory fuzzing is to find hidden directories on a web server by guessing names from a wordlist.
- **Wordlist (`-w`)**: The list of directory names to test.
- **Target URL (`-u`)**: The URL where `FUZZ` is the placeholder for the wordlist item.
```shell
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ
```
- **Result**: Ffuf will output any directory that returns a valid status code (e.g., 200 OK, 301 Redirect).
## 2. Page Fuzzing
Once directories are found, we look for specific files. This is often a two-step process: identifying the extension and then fuzzing the filename.
### Extension Fuzzing
Determine if the site uses `.php`, `.html`, `.aspx`, etc.
```shell
ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ
```
- **Note**: The placeholder `indexFUZZ` will become `index.php`, `index.html`, etc.
### File Fuzzing
Once you know the extension (e.g., `.php`), fuzz for files using that extension.
```shell
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php
```
## 3. Recursive Fuzzing
Instead of manually running a scan on every directory you find, you can tell ffuf to automatically scan subdirectories it discovers.
- **`-recursion`**: Enables recursive scanning.
- **`-recursion-depth 1`**: Limits how deep the scanner goes.
- **`-e .php`**: Specifies the extension to append to words during the scan.
- **`-v`**: Verbose mode (prints full URLs).
```shell
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v
```
## 4. Sub-domains vs. Virtual Hosts (VHosts)
Understanding the difference is crucial for proper targeting.
### DNS & Hosts File
If you are attacking a private target (like a CTF box or internal server), public DNS won't resolve domains like `academy.htb`. You must map the IP manually.
```shell
sudo sh -c 'echo "SERVER_IP  academy.htb" >> /etc/hosts'
```
### Sub-domain Fuzzing
This searches for A records (DNS) like `admin.inlanefreight.com`.
```shell
ffuf -w wordlist.txt:FUZZ -u https://FUZZ.inlanefreight.com/
```
### VHost Fuzzing
This searches for **Virtual Hosts**. The IP is the same, but the server serves different content based on the `Host` header.
- **Command**: The URL remains the IP, but we fuzz the `-H` (Header).
- **Filtering**: Vhost fuzzing often returns false positives (all requests return 200 OK). You must filter by size (`-fs`) to find the unique ones.
```shell
ffuf -w wordlist.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs 900
```
- **`-fs 900`**: Filter out responses that are 900 bytes (likely the default error or index page).
## 5. Parameter Fuzzing
If you find a page but it doesn't display data, it might require specific parameters (e.g., `admin.php?id=1`).
### GET Parameter Fuzzing
Fuzz the query string.
```shell
ffuf -w parameters.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs 1234
```
### POST Parameter Fuzzing
Fuzz the body of the request.
- **`-X POST`**: Change method to POST.
- **`-d`**: Data to send.
- **`-H`**: Set the Content-Type header (required for POST forms).
```shell
ffuf -w parameters.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs 1234
```
## 6. Value Fuzzing
Once a valid parameter is found (e.g., `id`), you can fuzz the **values** to find hidden data (Insecure Direct Object References - IDOR).
1. **Create a number list**:
```shell
for i in $(seq 1 1000); do echo $i >> ids.txt; done
```
2. **Fuzz the value**:
```shell
ffuf -w ids.txt:FUZZ -u http://target/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: ...' -fs xxx
```
## Summary of Key Flags

| **Flag**     | **Description**                | **Example**                |
| ------------ | ------------------------------ | -------------------------- |
| `-w`         | Wordlist file path and keyword | `-w list.txt:FUZZ`         |
| `-u`         | Target URL                     | `-u http://site.com/FUZZ`  |
| `-H`         | HTTP Header                    | `-H "Host: FUZZ.site.com"` |
| `-X`         | HTTP Method (GET/POST)         | `-X POST`                  |
| `-d`         | Request Body Data              | `-d "id=FUZZ"`             |
| `-fs`        | Filter response size           | `-fs 900`                  |
| `-fc`        | Filter status code             | `-fc 404`                  |
| `-recursion` | Scan subdirectories            | `-recursion`               |
