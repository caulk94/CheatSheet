# Dealing with End of Life Systems
## Server 2008 / 2008 R2 Escalation
Server 2008 systems lack modern mitigations like Credential Guard or robust Windows Defender. They are susceptible to many kernel exploits and configuration flaws.
**Reconnaissance & Enumeration:**
- **Sherlock:** A PowerShell script that quickly checks for missing patches related to privilege escalation (MS10-092, MS16-032, etc.).
- **Windows-Exploit-Suggester:** A Python tool that compares `systeminfo` output against a vulnerability database to identify missing patches.

**Exploitation Example (MS10-092):**
1. **Identify:** Sherlock flags the system as vulnerable to MS10-092 (Task Scheduler).
2. **Payload:** Use `msfvenom` or similar to create a reverse shell payload.
3. **Deliver:** Transfer the payload to the target.
4. **Execute:** Use the `exploit/windows/local/ms10_092_schelevator` Metasploit module.
    - Establish a Meterpreter session.
    - `use exploit/windows/local/ms10_092_schelevator`
    - Set `SESSION`, `LHOST`, `LPORT`.
    - Exploit to gain a SYSTEM shell.
## Windows 7 Escalation
Windows 7 also lacks critical security features found in Windows 10, such as VBS (Virtualization-Based Security) and AMSI (Antimalware Scan Interface), making PowerShell attacks highly effective.
**Exploitation Example (MS16-032 - Secondary Logon Handle):**
1. **Identify:** Windows-Exploit-Suggester or manual checks reveal the system is unpatched for MS16-032.
2. **Tooling:** Use `Invoke-MS16-032.ps1` (from Empire/PowerSploit).
3. **Execution:**
    - Bypass execution policy: `Set-ExecutionPolicy Bypass -Scope Process`
    - Import the module: `Import-Module .\Invoke-MS16-032.ps1`
    - Run the exploit: `Invoke-MS16-032`
4. **Result:** The script exploits a handle leak in the Secondary Logon Service to duplicate a SYSTEM token and spawn a high-integrity command prompt.
## Key Takeaways for Legacy Systems
- **Patching is rare:** Legacy systems often miss patches for years due to fear of breaking critical applications.
- **Kernel Exploits are reliable:** Unlike modern Windows where kernel exploits are difficult and risky, on legacy systems, they are often stable and effective.
- **Misconfigurations persist:** Older systems frequently have weak service permissions, unquoted service paths, and always-install-elevated settings enabled by default or legacy admins.
- **Business Context:** Always understand _why_ a legacy system exists before recommending its removal. Mitigating controls (segmentation) may be the only viable option for the client.